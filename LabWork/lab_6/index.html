<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
    <link href="./style.css" rel="stylesheet">
</head>

<body>

    <div class="main-centered-container">
        <h1>Создание прогнозной модели на основе линейной регрессии</h1>
        <h2>Изучение основных блоков TensorFlow.js</h2>
        <h3 class="header-border">Введение</h3>
        <p>В этом веб-приложении обучим модель линейной регрессии для прогнозирования пройденного
            расстояния на основе количества сделанных шагов.</p>
        <p>Линейная регрессия — это контролируемый подход(обучение с учителем), который строит модель или строит
            связь между набором независимых переменных
            и одной целевой и непрерывной переменной, то есть переменной,
            значение которой может быть любым числом между минимальным и максимальным значением.</p>
        <p>Набор данных состоит из 198 наблюдений шагов и данных о расстоянии Fitbit. Первая функция, шаги, играет роль независимой,
            в то время как столбец расстояния является целью(целевой функцией), которую хотим предсказать.</p>
        <h3 class="header-border">Загрузка и визуализация данных с помощью tfjs-vis</h3>
        <p>Первый шаг — загрузка данных. После нажатия кнопки
            ниже, загрузим набор данных из локального файла и построим его
            график с помощью tfjs-vis <a href="https://js.tensorflow.org/api_vis/latest/#render.scatterplot"
                target="_blank">scatterplot</a>.
        </p>
        <div id="load-plot"></div>
        <p>
            С правой стороны увидите визор tfjs-vis, отображающий данные, и можно понять, что он очень прост и линеен,
            поскольку темп шагов почти не меняется. Чтобы закрыть
            (или открыть) визор, нажмите кнопку с обратной кавычкой "`".
        </p>
        <p>
            Загрузив данные, приступим к обучению модели.
        </p>
        <h3 class="header-border">Обучение модели</h3>
        <p>
            Чтобы сделать обучение более динамичным, вручную зададим количество эпох,
            то есть количество раз, которое полный набор обучающих данных проходит по модели.
        </p>

        <p>
           Из опыта, 20 эпох достаточно. Данный параметр можно менять, чтобы увидеть
            различные результаты.
        </p>
        <p>
            Лучше использовать 35 эпох (они подсчитывают в большей степени лучше).
        </p>
        <label for="number-epochs">Введите количество эпох (ограничений нет)</label>
        <input type="number" id="number-epochs" name="number-epochs" min="1" value="5" style="width: 5em">
        <h4>Нажмите, чтобы обучить модель</h4>
        <div id="train-div"></div>
        <h3 class="header-border">Визуализация производительности модели</h3>
        <p>
            После начала обучения на визоре увидите две динамические линии,
            которые увеличиваются с течением времени. Эти значения представляют собой
            значение потерь обучения и среднеквадратичную ошибку в
            конце каждой эпохи. В нулевой эпохе обе оценки показывают очень высокое значение,
            но затем после первой эпохи обучения они резко падают из-за простоты набора данных.
        </p>
        <h3 class="header-border">Прогноз</h3>
        <p>
            После завершения обучения проверим на деле модель.
            Чтобы протестировать, введем количество пройденных шагов в поле ниже и выполним прогноз, который определит: какое расстояние было пройдено., нажав «Прогноз!».
            После нажатия кнопки приложение преобразует заданное значение в тензор ранга 1 и вызовет
            функцию <code>predict()</code> для вывода результата. Эта функция возвращает тензор, и для
            его вывода будем использовать <code>dataSync()</code> для синхронного получения результата
            прогноза и отображения его в строке ниже.
        </p>
        <p>
            Помимо прогнозирования, также добавим входное значение и ответ
            на диаграмму рассеивания. Таким образом, получим удобное представление о том,
            насколько точна (или неточна) модель.
        </p>
        <div id="predict">
        </div>
        <p>
            С большей точностью прогнозирование происходит на 35 эпох (иногда и на 20 эпохах, но бывают частые погрешности).
        </p>
        <ul>
            <li>На 50 эпохах больше 70% случаев - "красная зона", "желтая зона" не появляется, "зеленая зона" появилась от силы пару раз.</li>
            <li>На 45 эпохах часто появляется "желтая зона", соответственно и точность меньше.</li>
            <li>На 40 эпохах хуже отрабатывает по количеству разницы меньше 1.00, так как появляется в 60% случаев "красная зона" (больше 5.00) и "желтая зона", но "зеленая зона" улучшается по точности.</li>
            <li>На 35 эпохах тоже есть недостатки, прогноз не точен и не совершенен, но очень близок к точному результату (разница не превышает 1.00).</li>
            <li>На 30 эпохах работает как на 20 эпохах, но все же появляется значение меньше 1.00.</li>
            <li>На 25 эпохах уже не так часто появляется значение меньше 1.00, но тоже очень хорошо работает (но чем-то схоже с 35 эпохами).</li>
            <li>На 20 эпохах случаются больше погрешностей и часто эти погрешности превышают значение 1.00 в разнице.</li>
            <li>На 15 эпохах разница с ожидаемым результатом превышает более 5.00, что не очень хорошо (ни разу не был замечен результат разницы меньше 2.00).</li>
            <li>На 10 эпохах разница с настоящим ожиданием превышает более 5.00, что не очень хорошо (ни разу не был замечен результат разницы меньше 2.00).</li>
            <li>На 5 эпохах больше 80% случаев - "красная зона", "желтая зона" и "зеленая зона" не появляются.</li>
        </ul>
        <script src="./index.js"></script>
    </div>

</body>

</html>